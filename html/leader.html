<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leader Dashboard | Control Center</title>
    <link rel="stylesheet" href="../css/leader.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>

    <header class="main-header">
        <div class="user-profile">
            <img id="leaderAvatar" src="../asset/e8509f8003b9dc24c37ba8d92a9a069b.jpg" alt="Leader" class="avatar">
            <div class="user-meta">
                <h2 id="leaderName">Loading...</h2>
                <span class="badge-role" id="leaderRole">Leader</span>
            </div>
        </div>

        <div class="header-actions">
            <!-- RED DOT HIDDEN -->
            <span class="icon" onclick="logout()">Logout</span>

            <div class="icon-btn"><i class="fa-solid fa-bell"></i><span class="dot" style="display:none;"></span>
            </div>

            <div class="icon-btn" id="settingsBtn">
                <i class="fa-solid fa-gear"></i>
            </div>
            <div class="header-actions" role="banner">

                <div id="settingsModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true"
                    aria-labelledby="settingsTitle">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2 id="settingsTitle">Settings</h2>

                        <div class="settings-options">
                            <label>
                                Theme:
                                <select id="themeSelect">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                </select>
                            </label>

                            <label>
                                Notifications:
                                <input type="checkbox" id="notifToggle" checked>
                            </label>

                            <button id="saveSettings" class="btn-primary">Save Settings</button>
                        </div>
                    </div>
                </div>


            </div>
        </div>

    </header>

    <nav class="main-nav">
        <ul>
            <li class="active" data-page="campaigns">Campaigns</li>
            <li data-page="attendance">Attendance</li>
            <li data-page="balist">BA List</li>
            <li data-page="reports">Reports</li>
        </ul>

        <main class="dashboard-content">
            <!-- Campaigns Page -->
            <section class="page active" id="campaigns">

            <div class="section-header">
                <div>
                    <h1>My Campaigns</h1>
                    <p class="subtitle">Manage assigned campaigns and staff</p>
                </div>
                <div class="header-buttons">
                    <!-- <button class="btn-secondary" id="assignStaffBtn">
                        <i class="fa-solid fa-user-plus"></i> Assign Staff to Campaign
                    </button> -->
                    <div id="assignStaffModal" class="modal">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <h2>Assign Staff to Campaign</h2>
                            <div class="modal-form">
                                <label>Select Campaign:</label>
                                <select id="campaignSelect">
                                    <option value="">-- Choose Campaign --</option>
                                </select>

                                <label>Search & Select Users/BA:</label>
                                <input type="text" id="userSearch" placeholder="Search by name..." />
                                <div id="userList" class="user-selection-list"></div>

                                <button id="confirmAssign" class="btn-primary">Assign Selected Users</button>
                            </div>
                        </div>
                    </div>

                    <!-- Assign BA to Campaign Modal -->
                    <div id="assignBAModal" class="modal">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <h2 id="assignBATitle">Assign BA to Campaign</h2>
                            <input type="hidden" id="assignBACampaignId">
                            <div class="modal-form">
                                <label>Select Brand Ambassadors:</label>
                                <div id="baSelectionList" class="ba-selection-list" style="max-height: 300px; overflow-y: auto; padding: 10px; border: 1px solid #e5e7eb; border-radius: 6px; background: #f9fafb;">
                                    <!-- Populated by JavaScript -->
                                </div>
                                <button id="confirmAssignBA" class="btn-primary" style="margin-top: 15px;" onclick="handleConfirmAssignBA()">Confirm Assignment</button>
                            </div>
                        </div>
                    </div>

                    <div id="notification" class="notification" style="background:none;"></div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-label">Planned</span>
                    <div class="stat-value">0</div>
                    <span class="stat-change positive">Total Required</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Clocked-In</span>
                    <div class="stat-value">0</div>
                    <span class="stat-change">Active Now</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Attendance</span>
                    <div class="stat-value highlight">0%</div>
                    <span class="stat-change negative"></span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Avg Hours</span>
                    <div class="stat-value">0</div>
                    <span class="stat-change">Per Shift</span>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="left-col">
                    <div class="card table-card">
                        <div class="card-header">
                            <h3>Assigned Campaigns</h3>
                            <div class="search-box" style="margin-left:12px;">
                                <i class="fa-solid fa-magnifying-glass"></i>
                                <input type="text" id="campaignSearch" placeholder="Search campaigns..." autocomplete="off">
                            </div>
                        </div>
                        <div class="pro-table-wrapper">
                        <table class="pro-table">
                            <thead>
                                <tr>
                                    <th>Campaign Name</th>
                                    <th>Status</th>
                                    <th>Staff Count</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="campaignsTableBody"></tbody>
                        </table>
                        </div>
                    </div>

                    <div class="card table-card">

                        <div class="card-header">
                            <h3>Brand Ambassadors</h3>

                            <div class="search-box">
                                <i class="fa-solid fa-magnifying-glass"></i>
                                <input type="text" id="baSearch" placeholder="Search BA..." autocomplete="off">
                                <div id="baSuggestions" class="search-suggestions"></div>
                            </div>

                        </div>

                        <table class="pro-table">

                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Role</th>
                                    <th>Campaign</th>
                                    <th>Status</th>
                                </tr>
                            </thead>

                            <!-- ⭐ IMPORTANT ID -->
                            <tbody id="baTableBody">
                                <tr>
                                    <td colspan="4">Loading...</td>
                                </tr>
                            </tbody>

                        </table>

                    </div>

                </div>

                <div class="right-col">
                    <div class="card activity-card">
                        <h3>Real-Time Activity</h3>
                        <div class="activity-feed" id="activityFeed"></div>
                    </div>

                    <div class="card map-card">
                        <h3>Current Locations</h3>
                        <div class="mini-map" id="mapContainer">
                            <i class="fa-solid fa-map-location-dot"></i>
                            <p id="mapText">Select campaign to view locations</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Attendance Page -->
        <section class="page" id="attendance">
            <div class="card table-card">
                <div class="card-header">
                    <h3>Daily Attendance Monitoring</h3>
                    <div>
                        <h1>My Campaigns</h1>
                        <p class="subtitle">Manage assigned campaigns and staff</p>
                    </div>
                    <div class="header-buttons">
                        <button class="btn-secondary" id="assignStaffBtn">
                            <i class="fa-solid fa-user-plus"></i> Assign Staff to Campaign
                        </button>
                        <div id="assignStaffModal" class="modal">
                            <div class="modal-content">
                                <span class="close">&times;</span>
                                <h2>Assign Staff to Campaign</h2>
                                <div class="modal-form">
                                    <label>Select Campaign:</label>
                                    <select id="campaignSelect">
                                        <option value="">-- Choose Campaign --</option>
                                    </select>

                                    <label>Search & Select Users/BA:</label>
                                    <input type="text" id="userSearch" placeholder="Search by name..." />
                                    <div id="userList" class="user-selection-list"></div>

                                    <button id="confirmAssign" class="btn-primary">Assign Selected Users</button>
                                </div>
                            </div>
                        </div>

                        <!-- Assign BA to Campaign Modal -->
                        <div id="assignBAModal" class="modal">
                            <div class="modal-content">
                                <span class="close">&times;</span>
                                <h2 id="assignBATitle">Assign BA to Campaign</h2>
                                <input type="hidden" id="assignBACampaignId">
                                <div class="modal-form">
                                    <label>Select Brand Ambassadors:</label>
                                    <div id="baSelectionList" class="ba-selection-list"
                                        style="max-height: 300px; overflow-y: auto; padding: 10px; border: 1px solid #e5e7eb; border-radius: 6px; background: #f9fafb;">
                                        <!-- Populated by JavaScript -->
                                    </div>
                                    <button id="confirmAssignBA" class="btn-primary" style="margin-top: 15px;"
                                        onclick="handleConfirmAssignBA()">Confirm Assignment</button>
                                </div>
                            </div>
                        </div>

                        <div id="notification" class="notification" style="background:none;"></div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-label">Planned</span>
                        <div class="stat-value">0</div>
                        <span class="stat-change positive">Total Required</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Clocked-In</span>
                        <div class="stat-value">0</div>
                        <span class="stat-change">Active Now</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Attendance</span>
                        <div class="stat-value highlight">0%</div>
                        <span class="stat-change negative"></span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Avg Hours</span>
                        <div class="stat-value">0</div>
                        <span class="stat-change">Per Shift</span>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="left-col">
                        <div class="card table-card">
                            <div class="card-header">
                                <h3>Assigned Campaigns</h3>
                                <div class="search-box" style="margin-left:12px;">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                    <input type="text" id="campaignSearch" placeholder="Search campaigns..."
                                        autocomplete="off">
                                </div>
                            </div>
                            <div class="pro-table-wrapper">
                                <table class="pro-table">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>Status</th>
                                            <th>Staff Count</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="campaignsTableBody"></tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card table-card">

                            <div class="card-header">
                                <h3>Brand Ambassadors</h3>

                                <div class="search-box">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                    <input type="text" id="baSearch" placeholder="Search BA..." autocomplete="off">
                                    <div id="baSuggestions" class="search-suggestions"></div>
                                </div>

                            </div>

                            <table class="pro-table">

                                <thead>

                                    <tr>
                                        <th>Name</th>
                                        <th>Role</th>
                                        <th>Campaign</th>
                                        <th>Status</th>
                                    </tr>

                                </thead>

                                <!-- ⭐ IMPORTANT ID -->
                                <tbody id="baTableBody">
                                    <tr>
                                        <td colspan="4">Loading...</td>
                                    </tr>
                                </tbody>

                            </table>

                        </div>

                    </div>

                    <div class="right-col">
                        <div class="card activity-card">
                            <h3>Real-Time Activity</h3>
                            <div class="activity-feed" id="activityFeed"></div>
                        </div>

                        <div class="card map-card">
                            <h3>Current Locations</h3>
                            <div class="mini-map" id="mapContainer">
                                <i class="fa-solid fa-map-location-dot"></i>
                                <p id="mapText">Select campaign to view locations</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attendance Page -->
            <section class="page" id="attendance">
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Daily Attendance Monitoring</h3>
                        <div>
                            <label>Date:</label>
                            <input type="date" id="attendanceDateFilter">
                        </div>
                    </div>
                    <table class="pro-table">
                        <thead>
                            <tr>
                                <th>Staff Name</th>
                                <th>Photo</th>
                                <th>Location</th>
                                <th>Check-In</th>
                                <th>Check-Out</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody"></tbody>
                    </table>
                </div>

                <!-- Clock-In Detail Modal -->
                <div id="clockDetailModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2>Clock-In Details</h2>
                        <div class="detail-content">
                            <img id="clockDetailPhoto" src="" alt="Staff Photo"
                                style="max-width:300px;border-radius:8px;">
                            <p><strong>Staff:</strong> <span id="clockDetailName"></span></p>
                            <p><strong>Time:</strong> <span id="clockDetailTime"></span></p>
                            <p><strong>Location:</strong> <span id="clockDetailLocation"></span></p>
                            <p><strong>GPS Verified:</strong> <span id="clockDetailGPS"></span></p>
                            <p><strong>Notes:</strong> <span id="clockDetailNotes"></span></p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Staff List Page -->
            <section class="page" id="stafflist">
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Team Members</h3>
                        <div class="search-box">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input type="text" id="staffSearchInput" placeholder="Search staff...">
                        </div>
                    </div>
                    <table class="pro-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Photo</th>
                                <th>Role</th>
                                <th>Campaign</th>
                                <th>Contact</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="staffTableBody"></tbody>
                    </table>
                </div>

                <!-- Staff Detail Modal -->
                <div id="staffDetailModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2>Staff Details</h2>
                        <div class="staff-detail-content">
                            <img id="staffDetailPhoto" src="" alt="Staff Photo"
                                style="max-width:200px;border-radius:8px;">
                            <p><strong>Name:</strong> <span id="staffDetailName"></span></p>
                            <p><strong>Role:</strong> <span id="staffDetailRole"></span></p>
                            <p><strong>Campaign:</strong> <span id="staffDetailCampaign"></span></p>
                            <p><strong>Contact:</strong> <span id="staffDetailContact"></span></p>
                            <p><strong>Status:</strong> <span id="staffDetailStatus"></span></p>
                            <p><strong>Total Hours Today:</strong> <span id="staffDetailHours"></span></p>
                            <button id="reassignStaffBtn" class="btn-secondary">Reassign to Campaign</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reports Page -->
            <section class="page" id="reports">
                <div class="section-header">
                    <div>
                        <h1>Campaign Reports</h1>
                        <p class="subtitle">Attendance, performance & anomalies</p>
                    </div>
                    <div class="header-buttons">
                        <button class="btn-primary" id="generateReportBtn">
                            <i class="fa-solid fa-download"></i> Export Report
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card"><span class="stat-label">Attendance Rate</span>
                        <div class="stat-value highlight" id="reportAttendanceRate">0%</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">Active Staff</span>
                        <div class="stat-value" id="reportActiveStaff">0</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">Avg Work Hours</span>
                        <div class="stat-value" id="reportAvgHours">0</div>
                    </div>
                    <div class="stat-card"><span class="stat-label">Late Arrivals</span>
                        <div class="stat-value" id="reportLateArrivals">0</div>
                    </div>
                </div>

                <div class="card table-card">
                    <div class="card-header">
                        <h3>Campaign Performance</h3>
                        <div class="filter-group">
                            <label>Campaign:</label>
                            <select id="reportCampaignFilter">
                                <option value="">All Campaigns</option>
                            </select>
                            <label>Date Range:</label>
                            <input type="date" id="reportStartDate">
                            <span>to</span>
                            <input type="date" id="reportEndDate">
                            <button class="btn-secondary" id="applyReportFilter">Apply Filter</button>
                        </div>
                    </div>
                    <table class="pro-table">
                        <thead>
                            <tr>
                                <th>Staff</th>
                                <th>Campaign</th>
                                <th>Check-In</th>
                                <th>Check-Out</th>
                                <th>Hours Worked</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="reportTableBody"></tbody>
                    </table>
                </div>

                <div class="card table-card">
                    <div class="card-header">
                        <h3>Anomalies & Alerts</h3>
                    </div>
                    <table class="pro-table">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Staff</th>
                                <th>Details</th>
                                <th>Time</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="anomaliesTableBody"></tbody>
                    </table>
                </div>

                <div class="card chart-card">
                    <div class="card-header">
                        <h3>Weekly Attendance Summary</h3>
                    </div>
                    <div class="chart-container">
                        <div class="chart-y-axis">
                            <span>100%</span><span>75%</span><span>50%</span><span>25%</span><span>0%</span>
                        </div>
                        <div class="chart-bars">
                            <div class="bar-group">
                                <div class="bar-fill" style="height:0%;"></div><span class="bar-label">Mon</span>
                            </div>
                            <div class="bar-group">
                                <div class="bar-fill" style="height:0%;"></div><span class="bar-label">Tue</span>
                            </div>
                            <div class="bar-group">
                                <div class="bar-fill" style="height:0%;"></div><span class="bar-label">Wed</span>
                            </div>
                            <div class="bar-group">
                                <div class="bar-fill" style="height:0%;"></div><span class="bar-label">Thu</span>
                            </div>
                            <div class="bar-group">
                                <div class="bar-fill" style="height:0%;"></div><span class="bar-label">Fri</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Campaign Detail Modal -->
            <div id="campaignDetailModal" class="modal">
                <div class="modal-content" style="width: 700px; max-width: 96%; max-height: 90vh; overflow-y: auto;">
                    <span class="close">&times;</span>
                    <h2>Campaign Details</h2>
                    <div id="campaignDetailContent" style="display: flex; flex-direction: column; gap: 16px;">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- BA List Page -->
            <section class="page" id="balist">
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Brand Ambassadors</h3>
                        <div class="search-box">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input type="text" id="baSearchInput" placeholder="Search brand ambassadors...">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Campaign Detail Modal -->
        <div id="campaignDetailModal" class="modal">
            <div class="modal-content" style="height:30rem ;">
                <span class="close">&times;</span>
                <h2>Campaign Details</h2>
                <div id="campaignDetailContent" style="display: grid; gap: 20px;">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- BA List Page -->
        <section class="page" id="balist">
            <div class="card table-card">
                <div class="card-header">
                    <h3>Brand Ambassadors</h3>
                    <div class="search-box">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <input type="text" id="baSearchInput" placeholder="Search brand ambassadors...">
                    </div>
                </div>
            </section>
        </main>

        <script type="module" src="../js/leader.js"></script>
        

</body>

</html>